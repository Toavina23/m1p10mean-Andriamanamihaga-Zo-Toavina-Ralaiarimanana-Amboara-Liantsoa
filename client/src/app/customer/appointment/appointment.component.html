<div class="w-full h-full">
    <form (ngSubmit)="onSubmit()" [formGroup]="appointmentForm">
        @if (error != '') {
        <p class="text-red-600 font-semibold text-xs">{{error}}</p>
        }
        <div class=" sm:col-span-3 my-3 w-1/3">
            <label for="appointmentDate" class="block text-sm font-medium leading-6 text-gray-900">Date du
                rendez-vous</label>
            <div class="mt-2">
                <input type="datetime-local" formControlName="appointmentDate" id="appointmentDate"
                    autocomplete="given-name"
                    class="block w-full rounded-md border-0 p-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
                <p class="text-red-600 font-semibold text-xs">
                    @if (appointmentDate?.invalid && (appointmentDate?.dirty ||
                    appointmentDate?.touched)) {
                    @if (appointmentDate?.errors?.['required']) {
                    Date de rendez-vous requise
                    }
                    }
                    @else if(appointmentForm.errors?.['PastDate']){
                    Date de rendez-vous non valide
                    }
                </p>
            </div>
        </div>
        <div class="my-5">
            <div class="flex flex-row w-1/3 items-center gap-4 my-3">
                <div class="">
                    <p class="font-medium m-0">Services</p>
                </div>
                <button (click)="openDialog()" [disabled]="appointmentForm.invalid" mat-button color="primary">
                    + Ajouter
                </button>
            </div>
            <div cdkDropList class="flex flex-col gap-4" (cdkDropListDropped)="drop($event)">
                @for (task of tasks; track $index) {
                <app-customer-task [task]=task cdkDrag class="border w-1/2"></app-customer-task>
                }
            </div>
        </div>
        <div class="sm:col-span-3 my-3 w-1/3">
            <button type="submit" [disabled]="appointmentForm.invalid || loading || tasks.length == 0" mat-raised-button
                color="primary">
                Proc√©der au paiement
            </button>
        </div>
    </form>
</div>